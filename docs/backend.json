{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the TimeFlow application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents an event scheduled by a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the event entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Event)"
        },
        "title": {
          "type": "string",
          "description": "Title of the event."
        },
        "description": {
          "type": "string",
          "description": "Description of the event."
        },
        "startTime": {
          "type": "string",
          "description": "Start time of the event in ISO 8601 format.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "End time of the event in ISO 8601 format.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "description",
        "startTime",
        "endTime"
      ]
    },
    "Reminder": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Reminder",
      "type": "object",
      "description": "Represents a reminder for an event.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the reminder entity."
        },
        "eventId": {
          "type": "string",
          "description": "Reference to Event. (Relationship: Event 1:N Reminder)"
        },
        "reminderTime": {
          "type": "string",
          "description": "Time at which the reminder should be triggered, in ISO 8601 format.",
          "format": "date-time"
        },
        "message": {
          "type": "string",
          "description": "Message to be displayed when the reminder is triggered."
        },
        "channels": {
          "type": "object",
          "description": "The notification channels for the reminder.",
          "properties": {
            "email": {
              "type": "boolean"
            },
            "sms": {
              "type": "boolean"
            },
            "push": {
              "type": "boolean"
            }
          }
        }
      },
      "required": [
        "id",
        "eventId",
        "reminderTime",
        "message",
        "channels"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Each user has their own document under the 'users' collection.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "users/{userId}/events/{eventId}",
        "definition": {
          "entityName": "Event",
          "schema": {
            "$ref": "#/backend/entities/Event"
          },
          "description": "Stores events created by each user. Events are nested under the user's document. Includes denormalized 'userId' for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who created the event."
            },
            {
              "name": "eventId",
              "description": "The unique identifier for the event."
            }
          ]
        }
      },
      {
        "path": "users/{userId}/events/{eventId}/reminders/{reminderId}",
        "definition": {
          "entityName": "Reminder",
          "schema": {
            "$ref": "#/backend/entities/Reminder"
          },
          "description": "Stores reminders for each event. Reminders are nested under the event document. Includes denormalized 'userId' and 'eventId' for authorization independence.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user who created the event."
            },
            {
              "name": "eventId",
              "description": "The unique identifier for the event."
            },
            {
              "name": "reminderId",
              "description": "The unique identifier for the reminder."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to manage users, events, and reminders for the TimeFlow application. It leverages path-based ownership for user-specific data to ensure security and simplifies querying. The `users/{userId}/events/{eventId}` structure facilitates easy retrieval of events for a specific user and supports atomic operations for event creation and modification. Reminders are nested under events to maintain data locality and simplify reminder management. This structure achieves Authorization Independence as all event and reminder data are directly under the user's path, eliminating the need for `get()` calls to parent documents for authorization. Since this structure is strictly path-based, it inherently supports QAPs as list operations are scoped to a user's own events and reminders."
  }
}